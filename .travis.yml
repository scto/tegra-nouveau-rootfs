sudo: required
services:
- docker
before_install:
- sudo sh -c 'curl https://storage.googleapis.com/git-repo-downloads/repo > /usr/bin/repo'
- sudo chmod a+x /usr/bin/repo
- git config --global color.ui true
- "repo init -u https://github.com/vartom/tegra-nouveau-rootfs.git -m tegra-nouveau.xml > /dev/null"
- "repo sync -j4 -c > /dev/null"
- export TOP=$PWD
- export ARCH=aarch64
- "sudo apt install -y proot > /dev/null"
script:
- "./scripts/download-gcc > /dev/null"
- "./scripts/download-rootfs > /dev/null"
- "./scripts/prepare-rootfs > /dev/null"
- "./scripts/build-linux > /dev/null"
- "./scripts/build-mesa > /dev/null"
- "./scripts/build-kmscube > /dev/null"
- "./scripts/generate-rootfs > /dev/null"
deploy:
  provider: releases
  file: out/rootfs.tar.gz
  on:
    repo: vartom/tegra-nouveau-rootfs
    all_branches: true
